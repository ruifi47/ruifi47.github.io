<!doctype html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="HTB Cyber Apocalypse CTF 2022 - Reversing - WIDE, Rebuilding, Without a Trace &amp; Teleport writeups" /><meta property="og:locale" content="en" /><meta name="description" content="WIDE" /><meta property="og:description" content="WIDE" /><link rel="canonical" href="/posts/htbca2022_reversing/" /><meta property="og:url" content="/posts/htbca2022_reversing/" /><meta property="og:site_name" content="ruifi47" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-22T18:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="HTB Cyber Apocalypse CTF 2022 - Reversing - WIDE, Rebuilding, Without a Trace &amp; Teleport writeups" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-07-14T10:03:49+01:00","datePublished":"2022-05-22T18:00:00+01:00","description":"WIDE","headline":"HTB Cyber Apocalypse CTF 2022 - Reversing - WIDE, Rebuilding, Without a Trace &amp; Teleport writeups","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/htbca2022_reversing/"},"url":"/posts/htbca2022_reversing/"}</script><title>HTB Cyber Apocalypse CTF 2022 - Reversing - WIDE, Rebuilding, Without a Trace & Teleport writeups | ruifi47</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ruifi47"><meta name="application-name" content="ruifi47"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><body><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="/assets/img/logo.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><div class="site-title"> <a href="/">ruifi47</a></div><div class="site-subtitle fst-italic">Tech blog</div></div><ul class="nav flex-column flex-grow-1 w-100 ps-0"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/ruifi47" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['ruifi47','protonmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container px-xxl-5"><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100" > <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>HTB Cyber Apocalypse CTF 2022 - Reversing - WIDE, Rebuilding, Without a Trace & Teleport writeups</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4"><div class="post px-1 px-md-2"><h1 data-toc-skip>HTB Cyber Apocalypse CTF 2022 - Reversing - WIDE, Rebuilding, Without a Trace & Teleport writeups</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1653238800" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > May 22, 2022 </em> </span> <span> Updated <em class="" data-ts="1689325429" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jul 14, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/ruifi47">ruifi47</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1334 words" > <em>7 min</em> read</span></div></div></div><div class="post-content"><h1 id="wide"><strong>WIDE</strong></h1><h3 id="challenge-info"><span class="me-2"><strong>Challenge Info</strong></span><a href="#challenge-info" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote><p>We’ve received reports that Draeger has stashed a huge arsenal in the pocket dimension Flaggle Alpha. You’ve managed to smuggle a discarded access terminal to the Widely Inflated Dimension Editor from his headquarters, but the entry for the dimension has been encrypted. Can you make it inside and take control?</p></blockquote><p>For this challenge we are given an ELF 64-bit LSB pie executable x86-64 file called <strong>wide</strong> and a file named <strong>db.ex</strong>.</p><p>When we execute the <strong>wide</strong> file with <strong>db.ex</strong> as a parameter we are prompted with the following:</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/wide/wide1.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/wide/wide1.png" alt="wide1" class="lazyload" data-proofer-ignore></a></p><p>Since the challenge info refer to the Flaggle Alpha dimension, let’s select its correspondent number (<strong><code class="language-plaintext highlighter-rouge">6</code></strong>).</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/wide/wide2.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/wide/wide2.png" alt="wide2" class="lazyload" data-proofer-ignore></a> <em>Program output</em></p><p>By selecting the dimension number <strong><code class="language-plaintext highlighter-rouge">6</code></strong> (Flaggle Alpha), the program asks us for the <code class="language-plaintext highlighter-rouge">WIDE decryption key</code>.</p><p>Let’s now open the executable file <strong>wide</strong> in <a href="https://ghidra-sre.org/" title="Ghidra">Ghidra</a> to decompile the program.</p><p>After opening <strong>wide</strong> in Ghidra and selecting the <em>main</em> function, let’s go to the decompiler section to see if we can find some useful information.</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/wide/wide3.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/wide/wide3.png" alt="wide3" class="lazyload" data-proofer-ignore></a> <em>main function in Ghidra</em></p><p>In the <em>main</em> function we see some code responsible for displaying some error messages if we don’t run the program with the right parameters and also some code responsible for printing the text that we see when the program is being executed. In line 45, we can see that a function named <em>menu</em> is called so let’s take a look at what that function does.</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/wide/wide4.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/wide/wide4.png" alt="wide4" class="lazyload" data-proofer-ignore></a> <em>menu function in Ghidra</em></p><p>Looking at the function <em>menu</em>, we can see that in line 152, a string comparison is being made using <a href="https://www.cplusplus.com/reference/cwchar/wcscmp/" title="wcscmp"><code class="language-plaintext highlighter-rouge">wcscmp</code></a> to see if our input matches the string <strong><code class="language-plaintext highlighter-rouge">sup3rs3cr3tw1d3</code></strong>. So now let’s input the string <strong><code class="language-plaintext highlighter-rouge">sup3rs3cr3tw1d3</code></strong> when the program asks us for the <code class="language-plaintext highlighter-rouge">WIDE decryption key</code>.</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/wide/wide5.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/wide/wide5.png" alt="wide5" class="lazyload" data-proofer-ignore></a> <em>Program output the flag</em></p><p>And we get the flag <strong><code class="language-plaintext highlighter-rouge">HTB{str1ngs_4r3nt_4lw4ys_4sc11}</code></strong></p><p><br /></p><h1 id="rebuilding"><strong>Rebuilding</strong></h1><h3 id="challenge-info-1"><span class="me-2"><strong>Challenge Info</strong></span><a href="#challenge-info-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote><p>You arrive on a barren planet, searching for the hideout of a scientist involved in the Longhir resistance movement. You touch down at the mouth of a vast cavern, your sensors picking up strange noises far below. All around you, ancient machinery whirrs and spins as strange sigils appear and change on the walls. You can tell that this machine has been running since long before you arrived, and will continue long after you’re gone. Can you hope to understand its workings?</p></blockquote><p>The file that we get for this challenge is an ELF 64-bit LSB pie executable x86-64 called <strong>rebuilding</strong>.</p><p>When we execute the program with a password as a parameter we are prompted with the following:</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding1.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding1.png" alt="rebuilding1" class="lazyload" data-proofer-ignore></a></p><p>Looking at the output, we see that the program points out that the <code class="language-plaintext highlighter-rouge">Password length is incorrect</code>. So the first thing we are going to do is find the password length. Let’s open the executable file <strong>rebuilding</strong> in <a href="https://ghidra-sre.org/" title="Ghidra">Ghidra</a>.</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding2.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding2.png" alt="rebuilding2" class="lazyload" data-proofer-ignore></a> <em>main function in Ghidra</em></p><p>Looking at the line 19 in the <em>main</em> function above we can see a conditional statement to check <code class="language-plaintext highlighter-rouge">if (sVar1 == 0x20)</code>. 0x20 in hexadecimal is equal to 32 in Decimal. So the length of the password is 32 characters. Let’s run the program with a random 32 characters password to see what happens.</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding3.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding3.png" alt="rebuilding3" class="lazyload" data-proofer-ignore></a> <em>program output</em></p><p>The program takes a few seconds <code class="language-plaintext highlighter-rouge">Calculating</code> and then returns <code class="language-plaintext highlighter-rouge">The password is incorrect</code>. Let’s go back to Ghidra.</p><p>In line 38 of the <em>main</em> function we see a conditional statement that check <code class="language-plaintext highlighter-rouge">if (local_14 == 0x20)</code> the program outputs <em><code class="language-plaintext highlighter-rouge">The password is correct</code></em>.</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding4.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding4.png" alt="rebuilding4" class="lazyload" data-proofer-ignore></a> <em>Analyzing the main function</em></p><p>Analyzing the variable <code class="language-plaintext highlighter-rouge">local_14</code> previous appearances in the <em>main</em> function we note that in line 32 an array called <code class="language-plaintext highlighter-rouge">encrypted</code> is being XORed with a key.</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding5.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding5.png" alt="rebuilding5" class="lazyload" data-proofer-ignore></a> <em>Analyzing the <code class="language-plaintext highlighter-rouge">local_14</code> variable</em></p><p>By clicking on <code class="language-plaintext highlighter-rouge">encrypted</code> we can see some data in hex.</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding6.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding6.png" alt="rebuilding6" class="lazyload" data-proofer-ignore></a> <em>Analyzing the encrypted data</em></p><p>To quickly extract the hexadecimal data to build the <code class="language-plaintext highlighter-rouge">encrypted</code> array, select all the data of the picture above, right click and select <em><code class="language-plaintext highlighter-rouge">Copy Special...</code></em>.</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding7.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding7.png" alt="rebuilding7" class="lazyload" data-proofer-ignore></a> <em>Copying the hex data</em></p><p>Then select <em><code class="language-plaintext highlighter-rouge">Byte String</code></em> and click <em><code class="language-plaintext highlighter-rouge">OK</code></em>.</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding8.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding8.png" alt="rebuilding8" class="lazyload" data-proofer-ignore></a> <em>Copying the hex data 2</em></p><p>We extracted the following encoded string in hex: <strong><code class="language-plaintext highlighter-rouge">29 38 2b 1e 06 42 05 5d 07 02 31 42 0f 33 0a 55 00 00 15 1e 1c 06 1a 43 13 59 36 54 00 42 15 11 00</code></strong></p><p>Going back to the main function, by clicking on key we are able to view the string <strong><code class="language-plaintext highlighter-rouge">humans</code></strong> that supposedly is used as a key to XOR the hex string above and decode the data.</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding9.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding9.png" alt="rebuilding9" class="lazyload" data-proofer-ignore></a> <em>Finding the key <code class="language-plaintext highlighter-rouge">humans</code></em></p><p>Now we go to <a href="https://cyberchef.org/" title="CyberChef">CyberChef</a> and use the key <strong><code class="language-plaintext highlighter-rouge">humans</code></strong> to try to decode the hex string extracted earlier.</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding10.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding10.png" alt="rebuilding10" class="lazyload" data-proofer-ignore></a> <em>Decoding the hex string with the key <code class="language-plaintext highlighter-rouge">humans</code></em></p><p>As we can see from the picture above, it didn’t work. Let’s go back to Ghidra.</p><p>After analyzing more in-depth the program in Ghidra we find a very interesting function called <em>_INIT_1</em>.</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding11.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding11.png" alt="rebuilding11" class="lazyload" data-proofer-ignore></a> <em>Finding the key <code class="language-plaintext highlighter-rouge">aliens</code></em></p><p>Looking at the assembly code on the left we can see that the <strong><code class="language-plaintext highlighter-rouge">humans</code></strong> string is being replaced with the string <strong><code class="language-plaintext highlighter-rouge">aliens</code></strong>. The decompiler section on the right helps us to better visualize each letter that is going to form this string. Let’s test this string to see if we found the correct key to decrypt the hex data.</p><p>Go to CyberChef again and use the key <strong><code class="language-plaintext highlighter-rouge">aliens</code></strong> to decode the hex string.</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding12.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/rebuilding/rebuilding12.png" alt="rebuilding12" class="lazyload" data-proofer-ignore></a> <em>Decoding the hex string with the key <code class="language-plaintext highlighter-rouge">aliens</code></em></p><p>And we get the flag <strong><code class="language-plaintext highlighter-rouge">HTB{h1d1ng_1n_c0nstruct0r5_1n1t}</code></strong></p><p><br /></p><h1 id="without-a-trace"><strong>Without a Trace</strong></h1><h3 id="challenge-info-2"><span class="me-2"><strong>Challenge Info</strong></span><a href="#challenge-info-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote><p>Draeger’s mothership has suddenly vanished, he could be readying an attack! You need to track him down before disaster strikes…</p></blockquote><p>The file that we get for this challenge is an ELF 64-bit LSB pie executable x86-64 called <strong>without_a_trace</strong>.</p><p>When we run the executable we are prompted with the following output:</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/without-a-trace/without_a_trace1.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/without-a-trace/without_a_trace1.png" alt="without_a_trace1" class="lazyload" data-proofer-ignore></a></p><p>Let’s run the executable again but now using <a href="https://www.tutorialspoint.com/unix_commands/ltrace.htm" title="ltrace">ltrace</a> to see if we can get some useful information.</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/without-a-trace/without_a_trace2.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/without-a-trace/without_a_trace2.png" alt="without_a_trace2" class="lazyload" data-proofer-ignore></a> <em>Executing the program with ltrace</em></p><p>With ltrace we can see a string comparison the program makes between our input (<code class="language-plaintext highlighter-rouge">password1</code>) and the string <strong><code class="language-plaintext highlighter-rouge">IUCzus5b2^l2^tq^c5^t^f1f1|</code></strong> to check if the password is correct.</p><p>Let’s go to <a href="https://cyberchef.org/" title="CyberChef">CyberChef</a> and try to decode the string <strong><code class="language-plaintext highlighter-rouge">IUCzus5b2^l2^tq^c5^t^f1f1|</code></strong>.</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/without-a-trace/without_a_trace3.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/without-a-trace/without_a_trace3.png" alt="without_a_trace3" class="lazyload" data-proofer-ignore></a> <em>Decoding the flag in CyberChef</em></p><p>And we get the flag <strong><code class="language-plaintext highlighter-rouge">HTB{tr4c3_m3_up_b4_u_g0g0}</code></strong></p><p><br /></p><h1 id="teleport"><strong>Teleport</strong></h1><h3 id="challenge-info-3"><span class="me-2"><strong>Challenge Info</strong></span><a href="#challenge-info-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><blockquote><p>You’ve been sent to a strange planet, inhabited by a species with the natural ability to teleport. If you’re able to capture one, you may be able to synthesise lightweight teleportation technology. However, they don’t want to be caught, and disappear out of your grasp - can you get the drop on them?</p></blockquote><p>For this challenge we are given an ELF 64-bit LSB pie executable x86-64 stripped file called <strong>teleport</strong>.</p><p>When excuting the program with a password as a parameter, we get the following:</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/teleport/teleport1.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/teleport/teleport1.png" alt="teleport1" class="lazyload" data-proofer-ignore></a> <em>Program output</em></p><p>Let’s open <a href="https://ghidra-sre.org/" title="Ghidra">Ghidra</a> to analyze the program.</p><p>To start our analysis we go to the Symbol Tree section in Ghidra where we can see all the functions.</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/teleport/teleport2.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/teleport/teleport2.png" alt="teleport2" class="lazyload" data-proofer-ignore></a> <em>Symbol Tree section in Ghidra</em></p><p>Let’s analyze <em>FUN_00100b2a</em>.</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/teleport/teleport3.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/teleport/teleport3.png" alt="teleport3" class="lazyload" data-proofer-ignore></a> <em><code class="language-plaintext highlighter-rouge">FUN_00100b2a</code> in ghidra</em></p><p>In this function we can see an if statement on line 11 to check if the character <code class="language-plaintext highlighter-rouge">t</code> is in the address <code class="language-plaintext highlighter-rouge">0x00303291</code>.</p><p>When we go through the other functions, we see that they have a similar logic to <em>FUN_00100b2a</em> where the if statement checks if a character is in the correct address.</p><p>Take for example <em>FUN_00100f6a</em></p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/teleport/teleport4.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/teleport/teleport4.png" alt="teleport4" class="lazyload" data-proofer-ignore></a> <em><code class="language-plaintext highlighter-rouge">FUN_00100f6a</code> in ghidra</em></p><p>and <em>FUN_00100dd2</em></p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/teleport/teleport5.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/teleport/teleport5.png" alt="teleport5" class="lazyload" data-proofer-ignore></a> <em><code class="language-plaintext highlighter-rouge">FUN_00100dd2</code> in ghidra</em></p><p>Looking at these functions we can see similar character checks to the one shown earlier.</p><p>When we double click on <code class="language-plaintext highlighter-rouge">DAT_00303281</code>, Ghidra takes us to the following part in the listing section:</p><p><a href="/assets/img/posts/ctf-writeups/htbca2022/reversing/teleport/teleport6.png" class="popup img-link "><img data-src="/assets/img/posts/ctf-writeups/htbca2022/reversing/teleport/teleport6.png" alt="teleport6" class="lazyload" data-proofer-ignore></a></p><p>We can see a range of addresses from <code class="language-plaintext highlighter-rouge">0x00303280</code> to <code class="language-plaintext highlighter-rouge">0x003032aa</code> in which each of those addresses refer to a function.</p><p>As we seen earlier each function should contain a character that is being checked if it’s in the correct address with an if statement.</p><p>If we click on the function (in green) next to each address on that part of the listing section (of the last picture), we get to see the respective function and the corresponding character present in the if statement.</p><p>By putting together all the letters in the functions starting in address <code class="language-plaintext highlighter-rouge">0x00303280</code> and ending on the <code class="language-plaintext highlighter-rouge">0x003032aa</code> address, we get the flag:</p><p><strong><code class="language-plaintext highlighter-rouge">HTB{h0pp1ng_thru_th3_sp4c3_t1m3_c0nt1nuum!}</code></strong></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href='/categories/ctf-writeups/'>CTF writeups</a>, <a href='/categories/hackthebox-cyber-apocalypse-ctf-2022/'>HackTheBox Cyber Apocalypse CTF 2022</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/ctf-writeups/" class="post-tag no-text-decoration" >ctf-writeups</a> <a href="/tags/hackthebox/" class="post-tag no-text-decoration" >HackTheBox</a> <a href="/tags/htbca2022/" class="post-tag no-text-decoration" >HTBca2022</a> <a href="/tags/reverse-engineering/" class="post-tag no-text-decoration" >reverse-engineering</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted me-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=HTB%20Cyber%20Apocalypse%20CTF%202022%20-%20Reversing%20-%20WIDE,%20Rebuilding,%20Without%20a%20Trace%20&%20Teleport%20writeups%20-%20ruifi47&url=%2Fposts%2Fhtbca2022_reversing%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter" > <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=HTB%20Cyber%20Apocalypse%20CTF%202022%20-%20Reversing%20-%20WIDE,%20Rebuilding,%20Without%20a%20Trace%20&%20Teleport%20writeups%20-%20ruifi47&u=%2Fposts%2Fhtbca2022_reversing%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook" > <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2Fhtbca2022_reversing%2F&text=HTB%20Cyber%20Apocalypse%20CTF%202022%20-%20Reversing%20-%20WIDE,%20Rebuilding,%20Without%20a%20Trace%20&%20Teleport%20writeups%20-%20ruifi47" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram" > <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/htbca2022_puppeteer/">HTB Cyber Apocalypse CTF 2022 - Forensics - Puppeteer writeup</a><li class="text-truncate lh-lg"> <a href="/posts/kalmarctf2023_tinyshell/">Decrypting Cobalt Strike traffic - Kalmar CTF 2023 lleHSyniT! writeup</a><li class="text-truncate lh-lg"> <a href="/posts/htbca2022_reversing/">HTB Cyber Apocalypse CTF 2022 - Reversing - WIDE, Rebuilding, Without a Trace & Teleport writeups</a><li class="text-truncate lh-lg"> <a href="/posts/typhoonconctf2022_hidden_character/">TyphoonCon CTF 2022 - Web - Hidden Character writeup</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ctf-writeups/">ctf-writeups</a> <a class="post-tag btn btn-outline-primary" href="/tags/forensics/">forensics</a> <a class="post-tag btn btn-outline-primary" href="/tags/hackthebox/">HackTheBox</a> <a class="post-tag btn btn-outline-primary" href="/tags/htbca2022/">HTBca2022</a> <a class="post-tag btn btn-outline-primary" href="/tags/backdoor/">backdoor</a> <a class="post-tag btn btn-outline-primary" href="/tags/javascript/">javascript</a> <a class="post-tag btn btn-outline-primary" href="/tags/kalmarctf2023/">kalmarCTF2023</a> <a class="post-tag btn btn-outline-primary" href="/tags/reverse-engineering/">reverse-engineering</a> <a class="post-tag btn btn-outline-primary" href="/tags/sqli/">sqli</a> <a class="post-tag btn btn-outline-primary" href="/tags/typhoonconctf2022/">TyphoonConCTF2022</a></div></div></div><div id="toc-wrapper" class="ps-0 pe-4 mb-5"><div class="panel-heading ps-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-3 pe-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ms-1" data-toc-skip> Further Reading</h3><div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><div class="col"> <a href="/posts/htbca2022_puppeteer/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1653170400" data-df="ll" > May 21, 2022 </em><h4 class="pt-0 my-2" data-toc-skip>HTB Cyber Apocalypse CTF 2022 - Forensics - Puppeteer writeup</h4><div class="text-muted small"><p> Puppeteer Challenge Info Planet Longhir is known for it’s top-tier researchers. Due to their dedication in science and engineering, their military equipment is the most advanced one in the gal...</p></div></div></a></div><div class="col"> <a href="/posts/typhoonconctf2022_hidden_character/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1656176400" data-df="ll" > Jun 25, 2022 </em><h4 class="pt-0 my-2" data-toc-skip>TyphoonCon CTF 2022 - Web - Hidden Character writeup</h4><div class="text-muted small"><p> Hidden Character Challenge Description It takes one character [ ] to show you the path to salvation. And it takes a hidden character to lead you to the flag Let’s start by accessing the webs...</p></div></div></a></div><div class="col"> <a href="/posts/kalmarctf2023_tinyshell/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1678212000" data-df="ll" > Mar 7, 2023 </em><h4 class="pt-0 my-2" data-toc-skip>Decrypting Cobalt Strike traffic - Kalmar CTF 2023 lleHSyniT! writeup</h4><div class="text-muted small"><p> Introduction This writeup presents the intended solution for lleHSniT!, one of the forensics challenges of Kalmar CTF 2023. Description One of our users here at StupidCorp ran a malicious binar...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/htbca2022_puppeteer/" class="btn btn-outline-primary" prompt="Older" ><p>HTB Cyber Apocalypse CTF 2022 - Forensics - Puppeteer writeup</p></a> <a href="/posts/typhoonconctf2022_hidden_character/" class="btn btn-outline-primary" prompt="Newer" ><p>TyphoonCon CTF 2022 - Web - Hidden Character writeup</p></a></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/ctf-writeups/">ctf-writeups</a> <a class="post-tag btn btn-outline-primary" href="/tags/forensics/">forensics</a> <a class="post-tag btn btn-outline-primary" href="/tags/hackthebox/">HackTheBox</a> <a class="post-tag btn btn-outline-primary" href="/tags/htbca2022/">HTBca2022</a> <a class="post-tag btn btn-outline-primary" href="/tags/backdoor/">backdoor</a> <a class="post-tag btn btn-outline-primary" href="/tags/javascript/">javascript</a> <a class="post-tag btn btn-outline-primary" href="/tags/kalmarctf2023/">kalmarCTF2023</a> <a class="post-tag btn btn-outline-primary" href="/tags/reverse-engineering/">reverse-engineering</a> <a class="post-tag btn btn-outline-primary" href="/tags/sqli/">sqli</a> <a class="post-tag btn btn-outline-primary" href="/tags/typhoonconctf2022/">TyphoonConCTF2022</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div></div><footer><div class="container px-lg-4"><div class="d-flex justify-content-center align-items-center text-muted mx-md-3"><p>Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p><p>© 2023 <a href="https://github.com/ruifi47">ruifi47</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div></div></footer><div id="mask"></div><button id="back-to-top" aria-label="back-to-top" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.7/dayjs.min.js,npm/dayjs@1.11.7/locale/en.min.js,npm/dayjs@1.11.7/plugin/relativeTime.min.js,npm/dayjs@1.11.7/plugin/localizedFormat.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
